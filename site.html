// filepath: c:\Users\User\Documents\site.html.txt
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Отслеживание IP</title>
</head>
<body>
    <h1>ip:</h1>
    <p id="ip-display">Загрузка...</p>
    <h2>История посещений:</h2>
    <ul id="history-list"></ul>

    <script>
        // Получение IP через API
        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                const ip = data.ip;
                document.getElementById('ip-display').textContent = ip;

                // Отправка IP на локальный сервер
                fetch('http://localhost:3000/log-ip', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ip: ip })
                }).catch(error => console.error('Ошибка отправки:', error));

                // Хранение в localStorage (только для этого браузера)
                let history = JSON.parse(localStorage.getItem('ipHistory')) || [];
                if (!history.includes(ip)) {
                    history.push(ip);
                    localStorage.setItem('ipHistory', JSON.stringify(history));
                }

                // Отображение истории
                const list = document.getElementById('history-list');
                history.forEach(ip => {
                    const li = document.createElement('li');
                    li.textContent = ip;
                    list.appendChild(li);
            
    );
  });
</script>

                });
            })
            .catch(error => {
                document.getElementById('ip-display').textContent = 'Ошибка получения IP';
                console.error('Ошибка:', error);
            });
    </script>
</body>

</html>


